<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Final Cut — Dayshift</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0b1220" />
  <style>
    :root{
      --bg1:#070b14;
      --bg2:#0b1220;
      --card:#0f172a;
      --line:rgba(255,255,255,.10);
      --fg:#eaf0ff;
      --muted:rgba(234,240,255,.72);

      --accent:#7c3aed;      /* purple */
      --accent2:#22c55e;     /* green */
      --accent3:#06b6d4;     /* cyan */
      --warn:#f59e0b;        /* amber */
      --danger:#fb7185;      /* rose */

      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0; padding:18px;
      font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--fg);
      background:
        radial-gradient(1200px 600px at 10% 0%, rgba(124,58,237,.22), transparent 55%),
        radial-gradient(900px 500px at 90% 10%, rgba(6,182,212,.18), transparent 55%),
        radial-gradient(900px 600px at 50% 100%, rgba(34,197,94,.12), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      min-height:100vh;
    }
    header{
      display:flex; align-items:flex-start; justify-content:space-between;
      gap:12px; margin-bottom:14px; flex-wrap:wrap;
    }
    h1{font-size:20px; margin:0; letter-spacing:.2px}
    .sub{color:var(--muted); font-size:12px; margin-top:6px; line-height:1.35}
    nav{display:flex; gap:8px; flex-wrap:wrap; margin:10px 0 14px}
    .tab{
      padding:10px 12px; border-radius:14px; border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      font-weight:1000; font-size:13px; cursor:pointer;
      box-shadow: 0 2px 10px rgba(0,0,0,.18);
      transition:transform .06s ease, background .15s ease, border-color .15s ease;
    }
    .tab:active{transform:scale(.99)}
    .tab.active{
      background: linear-gradient(135deg, rgba(34,197,94,.30), rgba(6,182,212,.18));
      border-color: rgba(255,255,255,.18);
    }
    .card{
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(15,23,42,.92), rgba(11,18,32,.92));
      padding:14px;
      border-radius:18px;
      margin-bottom:12px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
    }
    .row{display:flex; align-items:flex-start; justify-content:space-between; gap:10px; flex-wrap:wrap}
    .stamp{font-size:11px; color:var(--muted)}
    .kpi{display:grid; grid-template-columns:repeat(3, minmax(0, 1fr)); gap:10px; margin-top:10px}
    .kpi > div{
      background:rgba(255,255,255,.03);
      border:1px solid var(--line);
      border-radius:16px;
      padding:10px;
    }
    .kpi .big{font-size:16px; font-weight:1000}
    .kpi .small{font-size:11px; color:var(--muted); margin-top:2px}
    .item{display:flex; align-items:flex-start; gap:10px; padding:9px 0; border-bottom:1px dashed rgba(255,255,255,.10)}
    .item:last-child{border-bottom:none}
    input[type="checkbox"]{
      width:18px; height:18px; margin-top:2px;
      accent-color: var(--accent2);
    }
    .label{font-weight:1000; font-size:13px}
    .meta{color:var(--muted); font-size:12px; margin-top:2px; line-height:1.35}
    .doneTag{color:var(--accent2); font-weight:1000; font-size:11px; margin-left:6px}
    .btnrow{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
    .btn{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      color:var(--fg);
      font-weight:1000;
      cursor:pointer;
      box-shadow: 0 2px 10px rgba(0,0,0,.18);
      transition:transform .06s ease, background .15s ease, border-color .15s ease;
    }
    .btn:active{transform:scale(.99)}
    .btn.danger{
      border-color: rgba(251,113,133,.35);
      background: rgba(251,113,133,.08);
    }
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      font-size:11px; font-weight:900; color:var(--muted);
    }
    .dot{width:8px; height:8px; border-radius:999px; background:var(--accent3)}
    .dot.rx{background:var(--warn)}
    .dot.sup{background:var(--accent2)}
    .dot.today{background:var(--accent)}
    .dot.track{background:var(--danger)}
    .inputs{display:grid; grid-template-columns:repeat(2, minmax(0, 1fr)); gap:10px; margin-top:10px}
    .inputs .box{
      background:rgba(255,255,255,.03);
      border:1px solid var(--line);
      border-radius:16px;
      padding:10px;
    }
    .inputs label{display:block; font-size:11px; color:var(--muted); margin-bottom:6px; font-weight:1000}
    .inputs input, .inputs textarea{
      width:100%;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.18);
      color:var(--fg);
      border-radius:14px;
      padding:10px;
      font-weight:900;
      font-size:13px;
      outline:none;
    }
    .inputs textarea{min-height:70px; resize:vertical}
    .sectionTitle{
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
      margin-bottom:6px;
    }
    .sectionTitle .left{display:flex; align-items:center; gap:10px}
    .glowLine{
      height:2px; width:100%;
      background: linear-gradient(90deg, rgba(124,58,237,.0), rgba(124,58,237,.6), rgba(6,182,212,.5), rgba(34,197,94,.4), rgba(34,197,94,.0));
      border-radius:999px;
      margin-top:10px;
    }
  </style>
</head>
<body>
  <header>
    <div>
      <h1>Final Cut — Dayshift</h1>
      <div class="sub" id="subtitle"></div>
      <div class="glowLine"></div>
    </div>
  </header>

  <nav>
    <div class="tab" id="tabToday" onclick="setTab('today')">Today</div>
    <div class="tab" id="tabRx" onclick="setTab('rx')">Prescriptions</div>
    <div class="tab" id="tabSupps" onclick="setTab('supps')">Supplements</div>
    <div class="tab" id="tabMacros" onclick="setTab('macros')">Macros</div>
    <div class="tab" id="tabTrack" onclick="setTab('track')">Tracker</div>
  </nav>

  <div id="view"></div>

<script>
/* =============================
   FINAL CUT — DAYSHIFT (Miguel)
   - Day shift schedule only
   - Training assumed 6:30–8:00 PM
   - Separate Rx + Supplements
   - Peptides = PRE-BED protocol
   - Daily reset of checkmarks
================================ */

const LS_KEY = "final_cut_dayshift_state_v1";

const DEFAULTS = {
  tab: "today",
  checks: {},
  tracker: { weight:"", bf:"", steps:"", sleep:"", training:"", notes:"" },
  lastResetDate: ""
};

const TARGETS = { cal: 1900, p: 215, c: 170, f: 50 };

function clone(obj){ return JSON.parse(JSON.stringify(obj)); }
function loadState(){
  try{
    const raw = localStorage.getItem(LS_KEY);
    if(!raw) return clone(DEFAULTS);
    const parsed = JSON.parse(raw);
    return {
      ...clone(DEFAULTS),
      ...parsed,
      checks: {...(parsed.checks||{})},
      tracker: {...clone(DEFAULTS.tracker), ...(parsed.tracker||{})}
    };
  }catch(e){ return clone(DEFAULTS); }
}
let state = loadState();
function saveState(){ localStorage.setItem(LS_KEY, JSON.stringify(state)); }

function todayISO(){
  const d = new Date();
  const y = d.getFullYear();
  const m = String(d.getMonth()+1).padStart(2,"0");
  const day = String(d.getDate()).padStart(2,"0");
  return `${y}-${m}-${day}`;
}
function maybeDailyReset(){
  const t = todayISO();
  if(state.lastResetDate !== t){
    state.checks = {};
    state.lastResetDate = t;
    saveState();
  }
}

function mk(id, label, meta){ return { id, label, meta }; }
function block(title, items){ return { title, items }; }

/* ===== TODAY (DAYSHIFT) PLAN ===== */
function getDayPlan(){
  return [
    {
      time:"3:30 AM",
      title:"Wake / Hydrate",
      macros:{p:25,c:35,f:2,cal:260},
      items:[
        mk("t_wake_shake","ISO100 + banana","Fast protein + carbs"),
        mk("t_wake_water","Water + electrolytes (optional AM LMNT)","If you sweat heavy at work")
      ]
    },
    {
      time:"6:30 AM",
      title:"Meal 2 (Work Fuel)",
      macros:{p:55,c:45,f:8,cal:480},
      items:[
        mk("t_m2_pro","7–9 oz chicken / lean protein","Keep fat low"),
        mk("t_m2_carb","1 cup cooked rice (or potato)","Stable energy"),
        mk("t_m2_veg","Veg / salsa / hot sauce","Volume + fiber")
      ]
    },
    {
      time:"11:30 AM",
      title:"Meal 3",
      macros:{p:55,c:45,f:10,cal:500},
      items:[
        mk("t_m3_pro","Lean protein","Rotate chicken/fish/96-4"),
        mk("t_m3_carb","Rice / oats / potato",""),
        mk("t_m3_veg","Veg","Gut support")
      ]
    },
    {
      time:"5:45 PM",
      title:"Pre-Workout",
      macros:{p:25,c:30,f:2,cal:240},
      items:[
        mk("t_pre_pro","ISO100 (or small protein meal)",""),
        mk("t_pre_carb","Add carbs (banana/oats/rice)","Fuel the 6:30PM session")
      ]
    },
    {
      time:"6:30–8:00 PM",
      title:"Training Block",
      macros:null,
      items:[
        mk("t_train","Lift 6:30–8:00","Get after it")
      ]
    },
    {
      time:"8:05 PM",
      title:"Dinner / Post",
      macros:{p:55,c:15,f:18,cal:520},
      items:[
        mk("t_post_pro","Lean protein + veg","Anchor the day"),
        mk("t_post_optional","Optional small carbs","Only if needed")
      ]
    },
    {
      time:"8:30–8:45 PM",
      title:"Pre-bed Lock-in",
      macros:null,
      items:[
        mk("t_winddown","Wind down (screens low, cool room)","Protect sleep = protect results"),
        mk("t_sleep","Lights out","Sleep target: 8:45 PM")
      ]
    }
  ];
}

/* ===== PRESCRIPTIONS (DAYSHIFT) ===== */
function getDayPrescriptions(){
  return [
    block("6:30 AM — With first real meal", [
      mk("rx_feno","Fenofibrate 145 mg","Take as prescribed (often with food)"),
      mk("rx_vascepa1","Vascepa (part 1 of daily total)","Total is 4 g/day — many split doses")
    ]),
    block("11:30 AM — Consistent time", [
      mk("rx_lisin","Lisinopril 20 mg","Same time daily")
    ]),
    block("8:05 PM — Evening / Dinner", [
      mk("rx_atorva","Atorvastatin 40 mg","Often taken in evening (follow your label)"),
      mk("rx_vascepa2","Vascepa (part 2 of daily total)","Completes daily total")
    ]),
    block("Pre-bed (8:30–8:45 PM)", [
      mk("rx_zoloft","Zoloft (sertraline) 50 mg","Take as prescribed (AM or PM depending on you)")
    ])
  ];
}

/* ===== SUPPLEMENTS (DAYSHIFT) — Peptides PRE-BED ===== */
function getDaySupplements(){
  return [
    block("3:30 AM — Wake", [
      mk("sup_lmnt","LMNT (1 pack)","Electrolytes + hydration"),
      mk("sup_glucosamine","Glucosamine","Joint support")
    ]),
    block("6:30 AM — With meal", [
      mk("sup_d3k2","Vitamin D3 + K2","With food is fine")
    ]),
    block("Pre-workout (5:45 PM)", [
      mk("sup_iso","Protein (ISO100)","Easy pre training protein")
    ]),
    block("Pre-bed (8:30–8:45 PM) — Protocol", [
      mk("sup_peptides","Peptides (AOD / CJC / Ipam combo)","Protocol: pre-bed"),
      mk("sup_glutathione","Glutathione","Added to your stack"),
      mk("sup_casein","Optional: Casein","Only if you need it for hunger/protein")
    ])
  ];
}

/* ===== State / UI ===== */
function setTab(tab){ state.tab = tab; saveState(); render(); }
function checked(id){ return !!state.checks[id]; }
function toggleCheck(id){ state.checks[id] = !state.checks[id]; saveState(); render(); }
function clearAllChecks(){ state.checks = {}; saveState(); render(); }

function syncHeader(){
  document.getElementById("subtitle").textContent =
    `Dayshift • Training 6:30–8:00 PM • Target ${TARGETS.cal} kcal | ${TARGETS.p}P / ${TARGETS.c}C / ${TARGETS.f}F • Peptides pre-bed`;
}

function sumMacros(plan){
  let p=0,c=0,f=0,cal=0;
  for(const b of plan){
    if(b.macros){ p+=b.macros.p||0; c+=b.macros.c||0; f+=b.macros.f||0; cal+=b.macros.cal||0; }
  }
  return {p,c,f,cal};
}
function countChecks(items){
  let total=0, done=0;
  for(const it of items){ total++; if(checked(it.id)) done++; }
  return {total, done};
}

/* ===== Renderers ===== */
function render(){
  document.getElementById("tabToday").classList.toggle("active", state.tab==="today");
  document.getElementById("tabRx").classList.toggle("active", state.tab==="rx");
  document.getElementById("tabSupps").classList.toggle("active", state.tab==="supps");
  document.getElementById("tabMacros").classList.toggle("active", state.tab==="macros");
  document.getElementById("tabTrack").classList.toggle("active", state.tab==="track");

  const view = document.getElementById("view");
  view.innerHTML = "";

  if(state.tab==="today") renderToday(view);
  if(state.tab==="rx") renderRx(view);
  if(state.tab==="supps") renderSupps(view);
  if(state.tab==="macros") renderMacros(view);
  if(state.tab==="track") renderTracker(view);
}

function renderToday(root){
  const plan = getDayPlan();
  const allItems = plan.flatMap(b => b.items || []);
  const prog = countChecks(allItems);

  const top = el("div","card");
  top.appendChild(el("div","row",
    el("div",null,
      el("div","sectionTitle",
        el("div","left", badge("today","Today"), strong("Checklist")),
        el("div","stamp",`Reset daily • ${todayISO()}`)
      ),
      el("div","sub","Tap items. Saves automatically.")
    )
  ));

  const k = el("div","kpi");
  k.appendChild(kpiBox(`${prog.done}/${prog.total}`,"Tasks done"));
  k.appendChild(kpiBox("6:30 PM","Training time"));
  k.appendChild(kpiBox(`${TARGETS.p}P / ${TARGETS.c}C / ${TARGETS.f}F`,"Daily target"));
  top.appendChild(k);

  const btnrow = el("div","btnrow");
  btnrow.appendChild(btn("Clear today checkmarks", () => clearAllChecks(), "danger"));
  top.appendChild(btnrow);

  root.appendChild(top);

  for(const b of plan){
    const card = el("div","card");
    card.appendChild(el("div",null,
      el("div","sectionTitle",
        el("div","left", badge("today", b.time), strong(b.title)),
        b.macros ? el("div","stamp",`${b.macros.cal} kcal • ${b.macros.p}P / ${b.macros.c}C / ${b.macros.f}F`) : el("div","stamp","")
      )
    ));
    for(const it of b.items){
      card.appendChild(checkRow(it.id, it.label, it.meta));
    }
    root.appendChild(card);
  }
}

function renderRx(root){
  const blocks = getDayPrescriptions();

  const top = el("div","card");
  top.appendChild(el("div",null,
    el("div","sectionTitle",
      el("div","left", badge("rx","Rx"), strong("Prescriptions")),
      el("div","stamp","Follow your label if different")
    ),
    el("div","sub","Zoloft 50mg • Lisinopril 20mg • Atorvastatin 40mg • Fenofibrate 145mg • Vascepa 4g/day")
  ));
  root.appendChild(top);

  for(const b of blocks){
    const card = el("div","card");
    card.appendChild(el("div","sectionTitle",
      el("div","left", badge("rx", b.title), strong("")),
      el("div","stamp","")
    ));
    for(const it of b.items){
      card.appendChild(checkRow(it.id, it.label, it.meta));
    }
    root.appendChild(card);
  }
}

function renderSupps(root){
  const blocks = getDaySupplements();

  const top = el("div","card");
  top.appendChild(el("div",null,
    el("div","sectionTitle",
      el("div","left", badge("sup","Stack"), strong("Supplements")),
      el("div","stamp","Peptides = pre-bed")
    ),
    el("div","sub","LMNT • D3+K2 • Glucosamine • Glutathione • Protein • Peptides (AOD/CJC/Ipam) pre-bed")
  ));
  root.appendChild(top);

  for(const b of blocks){
    const card = el("div","card");
    card.appendChild(el("div","sectionTitle",
      el("div","left", badge("sup", b.title), strong("")),
      el("div","stamp","")
    ));
    for(const it of b.items){
      card.appendChild(checkRow(it.id, it.label, it.meta));
    }
    root.appendChild(card);
  }
}

function renderMacros(root){
  const plan = getDayPlan();
  const sums = sumMacros(plan);

  const card = el("div","card");
  card.appendChild(el("div","sectionTitle",
    el("div","left", badge("today","Macros"), strong("Macro Map")),
    el("div","stamp","Dayshift")
  ));
  card.appendChild(el("div","sub","Planned macros from Today blocks. Log exact food in MyFitnessPal for precision."));

  const k1 = el("div","kpi");
  k1.appendChild(kpiBox(`${TARGETS.cal}`,"Target kcal"));
  k1.appendChild(kpiBox(`${sums.cal}`,"Planned kcal"));
  k1.appendChild(kpiBox(`${Math.max(0, TARGETS.cal - sums.cal)}`,"Kcal remaining"));
  card.appendChild(k1);

  const k2 = el("div","kpi");
  k2.appendChild(kpiBox(`${sums.p}/${TARGETS.p}`,"Protein (P)"));
  k2.appendChild(kpiBox(`${sums.c}/${TARGETS.c}`,"Carbs (C)"));
  k2.appendChild(kpiBox(`${sums.f}/${TARGETS.f}`,"Fat (F)"));
  card.appendChild(k2);

  root.appendChild(card);
}

function renderTracker(root){
  const t = state.tracker;

  const card = el("div","card");
  card.appendChild(el("div","sectionTitle",
    el("div","left", badge("track","Log"), strong("Tracker")),
    el("div","stamp","Saves on-device")
  ));
  card.appendChild(el("div","sub","Quick daily log: weight, BF%, steps, sleep, training, notes."));

  const inputs = el("div","inputs");
  inputs.appendChild(inputBox("Weight (lbs)","weight",t.weight,"e.g. 187.4"));
  inputs.appendChild(inputBox("Body fat %","bf",t.bf,"e.g. 18.0"));
  inputs.appendChild(inputBox("Steps","steps",t.steps,"e.g. 12000"));
  inputs.appendChild(inputBox("Sleep (hrs)","sleep",t.sleep,"e.g. 7.0"));
  inputs.appendChild(textBox("Training (what you did)","training",t.training,"Push / Pull / Legs..."));
  inputs.appendChild(textBox("Notes (HRV, hunger, water, etc.)","notes",t.notes,"Anything important today"));
  card.appendChild(inputs);

  const btnrow = el("div","btnrow");
  btnrow.appendChild(btn("Clear tracker fields", () => { state.tracker = {...DEFAULTS.tracker}; saveState(); render(); }, "danger"));
  card.appendChild(btnrow);

  root.appendChild(card);
}

/* ===== DOM Helpers ===== */
function el(tag, cls, ...kids){
  const n = document.createElement(tag);
  if(cls) n.className = cls;
  for(const k of kids){
    if(k === null || k === undefined) continue;
    if(typeof k === "string") n.appendChild(document.createTextNode(k));
    else n.appendChild(k);
  }
  return n;
}
function strong(text){
  const s = document.createElement("span");
  s.style.fontWeight = "1000";
  s.textContent = text;
  return s;
}
function badge(type, text){
  const b = document.createElement("span");
  b.className = "badge";
  const d = document.createElement("span");
  d.className = "dot " + (type || "");
  b.appendChild(d);
  b.appendChild(document.createTextNode(text));
  return b;
}
function btn(text, onClick, variant){
  const b = document.createElement("button");
  b.className = "btn" + (variant ? ` ${variant}` : "");
  b.textContent = text;
  b.onclick = onClick;
  return b;
}
function kpiBox(big, small){
  const d = el("div",null);
  d.appendChild(el("div","big", big));
  d.appendChild(el("div","small", small));
  return d;
}
function checkRow(id, label, meta){
  const wrap = el("div","item");
  const cb = document.createElement("input");
  cb.type = "checkbox";
  cb.checked = checked(id);
  cb.onchange = () => toggleCheck(id);

  const text = el("div",null,
    el("div","label", label, cb.checked ? el("span","doneTag","✓") : null),
    meta ? el("div","meta", meta) : el("div","meta","")
  );

  wrap.appendChild(cb);
  wrap.appendChild(text);
  return wrap;
}
function inputBox(title, key, value, placeholder){
  const box = el("div","box");
  box.appendChild(el("label",null,title));
  const input = document.createElement("input");
  input.value = value || "";
  input.placeholder = placeholder || "";
  input.oninput = (e) => { state.tracker[key] = e.target.value; saveState(); };
  box.appendChild(input);
  return box;
}
function textBox(title, key, value, placeholder){
  const box = el("div","box");
  box.appendChild(el("label",null,title));
  const ta = document.createElement("textarea");
  ta.value = value || "";
  ta.placeholder = placeholder || "";
  ta.oninput = (e) => { state.tracker[key] = e.target.value; saveState(); };
  box.appendChild(ta);
  return box;
}

/* ===== Boot ===== */
maybeDailyReset();
syncHeader();
if(!state.tab) state.tab="today";
render();
</script>
</body>
</html>
