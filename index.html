<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cut Control</title>
  <meta name="theme-color" content="#0b0b0b" />
  <style>
    :root{
      --bg:#0b0b0b; --card:#141414; --text:#fff; --muted:#bdbdbd;
      --border:rgba(255,255,255,.10); --accent:#40ff9a;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text)}
    header{position:sticky;top:0;background:rgba(11,11,11,.92);backdrop-filter:blur(10px);border-bottom:1px solid var(--border);z-index:20}
    .wrap{max-width:980px;margin:0 auto;padding:14px 12px 90px}
    .top{padding:14px 12px}
    h1{margin:0;font-size:18px}
    .sub{margin-top:6px;color:var(--muted);font-size:12px}
    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .tab{border:1px solid var(--border);background:transparent;color:var(--text);padding:10px 12px;border-radius:999px;font-weight:800;font-size:13px;cursor:pointer}
    .tab.active{border-color:rgba(64,255,154,.6);box-shadow:0 0 0 3px rgba(64,255,154,.12) inset}
    .pills{display:flex;gap:10px;flex-wrap:wrap;margin:12px 0}
    .pill{border:1px solid var(--border);padding:7px 10px;border-radius:999px;color:var(--muted);font-size:12px}
    .grid{display:grid;gap:12px}
    @media(min-width:840px){.grid{grid-template-columns:1fr 1fr}}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:14px}
    .card h2{margin:0 0 10px;font-size:14px}
    .block{border:1px solid var(--border);border-radius:14px;padding:12px;background:rgba(255,255,255,.02)}
    .time{display:flex;justify-content:space-between;gap:10px;align-items:center;font-weight:900;font-size:13px}
    .desc{margin-top:6px;color:var(--muted);font-size:12px;line-height:1.35}
    .checks{margin-top:10px;display:grid;gap:8px;border-top:1px dashed rgba(255,255,255,.12);padding-top:10px}
    label{display:flex;gap:10px;align-items:flex-start}
    input[type="checkbox"]{margin-top:2px;transform:scale(1.15);accent-color:var(--accent)}
    .footer{position:fixed;left:0;right:0;bottom:0;background:rgba(11,11,11,.92);backdrop-filter:blur(10px);border-top:1px solid var(--border)}
    .footWrap{max-width:980px;margin:0 auto;padding:10px 12px;display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .btns{display:flex;gap:10px;flex-wrap:wrap}
    button{border:1px solid var(--border);background:rgba(255,255,255,.02);color:var(--text);padding:10px 12px;border-radius:12px;font-weight:900;font-size:13px;cursor:pointer}
    button:hover{border-color:rgba(255,255,255,.20)}
    .tiny{color:var(--muted);font-size:12px}
  </style>
</head>

<body>
<header>
  <div class="top">
    <h1>Cut Control</h1>
    <div class="sub">Simple daily plan • check-offs saved on this device</div>
    <div class="tabs">
      <button class="tab active" data-mode="dayshift">Dayshift</button>
      <button class="tab" data-mode="nightshift">Nightshift</button>
      <button class="tab" data-mode="offday">Off Day</button>
    </div>
  </div>
</header>

<div class="wrap">
  <div class="pills">
    <div class="pill" id="modePill">Mode: Dayshift</div>
    <div class="pill" id="timesPill">Wake 2:30 AM • Train 3:00–4:00 AM • Sleep 7:30 PM</div>
  </div>

  <div class="grid" id="content"></div>
</div>

<div class="footer">
  <div class="footWrap">
    <div class="tiny" id="progress">0 / 0 done</div>
    <div class="btns">
      <button id="markAll">Mark all</button>
      <button id="reset">Reset today</button>
    </div>
  </div>
</div>

<script>
  // ----------------- PLAN DATA (FRESH START) -----------------
  // Dayshift is fully built and optimized for:
  // Wake 2:30 AM, Train 3–4 AM, Sleep 7:30 PM.
  // Nightshift/Offday are placeholders to edit later.

  const plans = {
    dayshift: {
      title: "Dayshift",
      times: "Wake 2:30 AM • Train 3:00–4:00 AM • Sleep 7:30 PM",
      sections: [
        {
          title: "Wake + Prime",
          blocks: [
            {
              time: "2:30 AM",
              desc: "Hydrate + electrolytes immediately. Sets performance + prevents cramps on early training.",
              checks: [
                "16–24 oz water",
                "Electrolytes (LMNT or Squench Zero)"
              ]
            },
            {
              time: "2:35 AM",
              desc: "AM meds that don’t need food/fat (and are usually fine early). Follow your prescription label if it conflicts.",
              checks: [
                "Lisinopril 20 mg",
                "Bupropion AM (ONLY if prescribed)"
              ]
            }
          ]
        },
        {
          title: "Pre-Workout",
          blocks: [
            {
              time: "2:45 AM",
              desc: "Best early lift fuel: banana + whey isolate (fast carbs + fast protein).",
              checks: [
                "Banana",
                "Whey isolate (ISO100)"
              ]
            },
            {
              time: "2:50 AM",
              desc: "Optional: L-theanine smooths caffeine + focus (if you use caffeine).",
              checks: [
                "L-theanine 100–200 mg (optional)"
              ]
            }
          ]
        },
        {
          title: "Training + Post",
          blocks: [
            {
              time: "3:00–4:00 AM",
              desc: "Train. Sip water. Add electrolytes if you sweat heavy.",
              checks: [
                "Workout done",
                "Hydration during training"
              ]
            },
            {
              time: "4:15 AM",
              desc: "Post workout shake + creatine (easy daily anchor).",
              checks: [
                "Post-workout whey isolate",
                "Creatine 5 g"
              ]
            }
          ]
        },
        {
          title: "Meals + Supplements (Best absorption timing)",
          blocks: [
            {
              time: "7:15 AM — Meal 1",
              desc: "First full meal ~3 hours after shake. Include a little fat for absorption of D3/K2/Vit A + multi.",
              checks: [
                "Meal 1 (lean protein + carbs + small fat)",
                "Vitamin D3",
                "Vitamin K2",
                "Vitamin A (10,000 IU) / A-pack",
                "Multi pack vitamin (with meal)"
              ]
            },
            {
              time: "11:00 AM — Meal 2",
              desc: "With food is usually best for glucosamine + Vascepa (split dose).",
              checks: [
                "Meal 2",
                "Glucosamine (with food)",
                "Vascepa (part 1 of total daily)"
              ]
            },
            {
              time: "2:30 PM — Meal 3",
              desc: "Steady energy. Take fenofibrate with food if your label says so.",
              checks: [
                "Meal 3",
                "Fenofibrate 145 mg (per label)"
              ]
            },
            {
              time: "5:45 PM — Final Meal",
              desc: "Early final meal = better sleep. Finish Vascepa daily total if splitting.",
              checks: [
                "Final meal",
                "Vascepa (remainder to reach 4 g/day total)"
              ]
            }
          ]
        },
        {
          title: "Evening + Sleep Stack",
          blocks: [
            {
              time: "6:45 PM",
              desc: "Atorvastatin is commonly taken in the evening (follow your label).",
              checks: [
                "Atorvastatin 40 mg"
              ]
            },
            {
              time: "7:00 PM",
              desc: "Magnesium before bed for relaxation/sleep quality.",
              checks: [
                "Magnesium (bisglycinate)"
              ]
            },
            {
              time: "7:05 PM",
              desc: "If you run peptides pre-bed, keep timing consistent.",
              checks: [
                "Peptide stack (optional)"
              ]
            },
            {
              time: "7:10 PM",
              desc: "Casein is optional pre-bed. If it makes you too full, move earlier.",
              checks: [
                "Casein (optional)"
              ]
            },
            {
              time: "7:30 PM",
              desc: "Lights out.",
              checks: [
                "Sleep"
              ]
            }
          ]
        }
      ]
    },

    nightshift: {
      title: "Nightshift",
      times: "Placeholder (edit later)",
      sections: [
        {
          title: "Nightshift (placeholder)",
          blocks: [
            {
              time: "—",
              desc: "Paste your nightshift schedule here later and I’ll format it the same.",
              checks: ["Nightshift plan stays as placeholder for now"]
            }
          ]
        }
      ]
    },

    offday: {
      title: "Off Day",
      times: "Placeholder (edit later)",
      sections: [
        {
          title: "Off Day (placeholder)",
          blocks: [
            {
              time: "—",
              desc: "Add your lower-cal off-day structure here later.",
              checks: ["Off day plan stays as placeholder for now"]
            }
          ]
        }
      ]
    }
  };

  // ----------------- STATE (SAVES DAILY) -----------------
  const STORAGE_KEY = "cutcontrol_reset_v1";
  const TODAY = new Date().toISOString().slice(0,10); // YYYY-MM-DD
  let state = load();

  function load(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return { mode:"dayshift", days:{} };
      const s = JSON.parse(raw);
      if(!s.mode) s.mode = "dayshift";
      if(!s.days) s.days = {};
      if(!s.days[TODAY]) s.days[TODAY] = {};
      return s;
    }catch(e){
      return { mode:"dayshift", days:{} };
    }
  }
  function bucket(){
    if(!state.days[TODAY]) state.days[TODAY] = {};
    if(!state.days[TODAY][state.mode]) state.days[TODAY][state.mode] = {};
    return state.days[TODAY][state.mode];
  }
  function save(){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    updateProgress();
  }

  // ----------------- RENDER -----------------
  const tabs = [...document.querySelectorAll(".tab")];
  tabs.forEach(btn=>{
    btn.addEventListener("click", ()=>{
      tabs.forEach(t=>t.classList.remove("active"));
      btn.classList.add("active");
      state.mode = btn.dataset.mode;
      save();
      render();
    });
  });

  function render(){
    const plan = plans[state.mode];
    document.getElementById("modePill").textContent = "Mode: " + plan.title;
    document.getElementById("timesPill").textContent = plan.times;

    const root = document.getElementById("content");
    root.innerHTML = "";

    plan.sections.forEach((sec, sIdx)=>{
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `<h2>${sec.title}</h2>`;

      sec.blocks.forEach((blk, bIdx)=>{
        const block = document.createElement("div");
        block.className = "block";

        const head = document.createElement("div");
        head.className = "time";
        head.innerHTML = `<span>${blk.time}</span><span class="tiny">${plan.title}</span>`;
        block.appendChild(head);

        const desc = document.createElement("div");
        desc.className = "desc";
        desc.textContent = blk.desc || "";
        block.appendChild(desc);

        const checks = document.createElement("div");
        checks.className = "checks";

        (blk.checks||[]).forEach((text, cIdx)=>{
          const key = `${state.mode}::${sIdx}::${bIdx}::${cIdx}`;
          const row = document.createElement("label");

          const cb = document.createElement("input");
          cb.type = "checkbox";
          cb.checked = !!bucket()[key];
          cb.addEventListener("change", ()=>{
            bucket()[key] = cb.checked ? 1 : 0;
            save();
          });

          const t = document.createElement("div");
          t.innerHTML = `<div style="font-weight:900;font-size:13px">${escapeHtml(text)}</div>`;

          row.appendChild(cb);
          row.appendChild(t);
          checks.appendChild(row);
        });

        block.appendChild(checks);
        card.appendChild(block);
      });

      root.appendChild(card);
    });

    updateProgress();
  }

  function escapeHtml(str){
    return String(str).replace(/[&<>"']/g, s=>({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
    }[s]));
  }

  function updateProgress(){
    const plan = plans[state.mode];
    const b = bucket();
    let total = 0, done = 0;

    plan.sections.forEach((sec,sIdx)=>{
      sec.blocks.forEach((blk,bIdx)=>{
        (blk.checks||[]).forEach((_,cIdx)=>{
          total++;
          const key = `${state.mode}::${sIdx}::${bIdx}::${cIdx}`;
          if(b[key]) done++;
        });
      });
    });

    document.getElementById("progress").textContent = `${done} / ${total} done`;
  }

  document.getElementById("reset").addEventListener("click", ()=>{
    if(!state.days[TODAY]) state.days[TODAY] = {};
    state.days[TODAY][state.mode] = {};
    save();
    render();
  });

  document.getElementById("markAll").addEventListener("click", ()=>{
    const plan = plans[state.mode];
    const b = bucket();
    plan.sections.forEach((sec,sIdx)=>{
      sec.blocks.forEach((blk,bIdx)=>{
        (blk.checks||[]).forEach((_,cIdx)=>{
          const key = `${state.mode}::${sIdx}::${bIdx}::${cIdx}`;
          b[key] = 1;
        });
      });
    });
    save();
    render();
  });

  // init active tab
  tabs.forEach(t=>t.classList.toggle("active", t.dataset.mode===state.mode));
  render();
</script>
</body>
</html>
